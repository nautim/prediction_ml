## adding necessary libraries
library(data.table)
library(stringr)
library(readr)
library(skimr)
library(Hmisc)
library(caret)
library(randomForest)
library(scales)
library(ranger)
library(pdp)

## setting seed
set.seed(1234)

## uploading data 
paris <- fread("/Users/nautim/Desktop/Data and Econometrics/Predictions with ML/listings.csv")

## filtering data according to the task
paris_cleaned <- paris %>%
  filter(accommodates >= 2 & accommodates <= 6 & # accomodates between 2 and 6 people
          room_type == "Entire home/apt" & 
           !str_detect(paris_cleaned$property_type, c("condo|house|House|cottage|room|Room|Island|Barn|bed|Boat|Cave|suite|villa|bungalow|reside")) &
                         bedrooms %in% c(1, 2, 3)) # have 1 to 3 bedrooms (small & midsize appartement)

ggplot(paris_cleaned, aes(x = bedrooms)) + geom_bar()

## looking at the number of unique values in each of the variable
unique <- c()
for (i in colnames(paris_cleaned)) {
  n <- NROW(unique(paris_cleaned[[i]]))
  unique <- append(unique, n)
}

unique_variables_n <- tibble(colnames(paris_cleaned), unique)
unique_variables_n %>%
  arrange(desc(unique))
 
## deleting pointless variables 
paris_cleaned <- paris_cleaned %>%
  select(-c("id", "listing_url", "picture_url", "description", "name", "host_url", "host_id", "host_url", "host_thumbnail_url", "host_picture_url",
  "neighborhood_overview", "host_about", "license", "scrape_id", "neighbourhood_group_cleansed", "calendar_updated", "last_scraped", "host_location", 
  "host_name", "host_since", "host_neighbourhood", "host_verifications", "neighbourhood"), 
         -contains("calculated_host_listings"),
         -contains("listings_count"))



